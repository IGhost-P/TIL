# TIL ê°„ë‹¨íšŒê³ 

> ì´ë²ˆì£¼ì— JSë¶€ë¶„ì€ ëë‚ ê²ƒ ê°™ë‹¤, JS ê´€ë ¨ ì‹¤ìŠµì€ ë°”ë‹ë¼JSìŠ¤í„°ë”” ê³¼ì œë¡œ ë§ˆë¬´ë¦¬í•œë‹¤ ìƒê°í•˜ì
> ì´ì œ TSë‘ node.jsë¥¼ ì¤‘ì ì ìœ¼ë¡œ ëŒë¦¬ë©´ ë ê²ƒê°™ë‹¤
> ì•Œê³ ë¦¬ì¦˜ì€ ì–´ëŠ ë°©í–¥ìœ¼ë¡œ ê°€ì•¼í• ì§€ ê°ì´ ì•ˆì¡íŒë‹¤, ì•Œê³ ë¦¬ì¦˜ ê´€ë ¨ ìŠ¤í„°ë””ë¥¼ ì•Œì•„ë³´ë©´ ì¢‹ì„ê²ƒ ê°™ë‹¤

# Today I Learned

- [x] VanillaJS
- [x] ì•Œê³ ë¦¬ì¦˜

---

# ğŸ“¹ ë™ì˜ìƒ

[![section13](../../img/ì¸ë„¤ì¼/TIL.png)](https://youtu.be/jpj0Kw8WzBI)

# VanillaJS

## The MVC Architecture

> ì•„í‚¤í…ì²˜ì˜ êµ¬ì¡°, ìœ ì§€ë³´ìˆ˜, í™•ì¥ì„±ì„ ëª¨ë‘ ê³ ë ¤í•˜ëŠ”ê±´ ì¤‘ìš”í•˜ë‹¤, í•˜ì§€ë§Œ ì„œë¹„ìŠ¤ì˜ ê·œëª¨ê°€ ì»¤ì§ì— ë”°ë¼ ê°œì¸ì´ ê°ë‹¹í•˜ê¸° í˜ë“¤ë‹¤
> ì´ë¯¸ ì¦ë©´ëœ ë””ìì¸ íŒ¨í„´ì´ë‚˜ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ë©´ ì¢‹ë‹¤

## Architectureì˜ êµ¬ì„±ìš”ì†Œ

- Business Logic
- state
- HTTP Library
- Application Logic
- presentation logic

## MVC Architecture

![MVC](../../img/0316_01.png)

- viewì—ì„œ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ controllerì—ì„œ ê´€ë¦¬ë¥¼ í•˜ê³  í•´ë‹¹ ë¡œì§ì„ modelì´ ì²˜ë¦¬í•œë‹¤

## Refactoring for MVC

### View

```jsx
import icons from "url:../../img/icons.svg"; // parcel 2
class RecipeView {
  #parentElement = document.querySelector(".recipe"); // ì»¨íŠ¸ë¡¤ì—ì„œ ì‚¬ìš©í•˜ë©´ ì¢‹ë‹¤, í•˜ì§€ë§Œ í•˜ë‚˜ì´ìƒì˜ viewë¥¼ ë§Œë“¤ê²Œë˜ë©´ ë°›ì•„ì˜¬ë•Œë§ˆë‹¤ í•˜ë‚˜í•˜ë‚˜ ì§€ì •í•´ì¤˜ì•¼í•˜ë‹ˆ, ê°ì²´ë¥¼ ìƒì„±í•˜ì
  #data; // renderì— ë“¤ì–´ê°ˆ ë°ì´í„°

  render(data) {
    this.#data = data;
    const markup = this.#generateMarkup();
    this.#clear;
    this.#parentElement.insertAdjacentHTML("afterbegin", markup); //
  }

  #clear() {
    this.#parentElement.innerHTML = "";
  }

  // ì´ê²ƒì€ ìº¡ìŠí™” í•˜ì§€ ì•Šê³ , controllerì—ì„œ ì‚¬ìš©í• ìˆ˜ ìˆê²Œ í•œë‹¤
  renderSpinner = function () {
    const markup = `
      <div class="spinner">
      <svg>
        <use href="${icons}#icon-loader"></use>
      </svg>
    </div> 
    `;
    this.#parentElement.innerHTML = "";
    this.#parentElement.insertAdjacentHTML("afterbegin", markup);
  };

  #generateMarkup() {
    return `
      <figure class="recipe__fig">
        <img src="${this.#data.image}" alt="${
      this.#data.title
    }" class="recipe__img" />
        <h1 class="recipe__title">
          <span>${this.#data.title}</span>
        </h1>
      </figure>

      <div class="recipe__details">
        <div class="recipe__info">
          <svg class="recipe__info-icon">
            <use href="${icons}#icon-clock"></use>
          </svg>
          <span class="recipe__info-data recipe__info-data--minutes">${
            this.#data.cookingTime
          }</span>
          <span class="recipe__info-text">minutes</span>
        </div>
        <div class="recipe__info">
          <svg class="recipe__info-icon">
            <use href="${icons}#icon-users"></use>
          </svg>
          <span class="recipe__info-data recipe__info-data--people">4</span>
          <span class="recipe__info-text">s${this.#data.servings}</span>

          <div class="recipe__info-buttons">
            <button class="btn--tiny btn--increase-servings">
              <svg>
                <use href="${icons}#icon-minus-circle"></use>
              </svg>
            </button>
            <button class="btn--tiny btn--increase-servings">
              <svg>
                <use href="${icons}#icon-plus-circle"></use>
              </svg>
            </button>
          </div>
        </div>

        <div class="recipe__user-generated">
          <svg>
            <use href="${icons}#icon-user"></use>
          </svg>
        </div>
        <button class="btn--round">
          <svg class="">
            <use href="${icons}#icon-bookmark-fill"></use>
          </svg>
        </button>
      </div>

      <div class="recipe__ingredients">
        <h2 class="heading--2">Recipe ingredients</h2>
        <ul class="recipe__ingredient-list">
        ${this.#data.ingredients
          .map((ing) => {
            return `
            <li class="recipe__ingredient">
            <svg class="recipe__icon">
              <use href="${icons}#icon-check"></use>
            </svg>
            <div class="recipe__quantity">${ing.quantity}</div>
            <div class="recipe__description">
              <span class="recipe__unit">${ing.unit}</span>
              ${ing.description}
            </div>
          </li>
          `;
          })
          .join("")}
      
        </ul>
      </div>

      <div class="recipe__directions">
        <h2 class="heading--2">How to cook it</h2>
        <p class="recipe__directions-text">
          This recipe was carefully designed and tested by
          <span class="recipe__publisher">${
            this.#data.publisher
          }/span>. Please check out
          directions at their website.
        </p>
        <a
          class="btn--small recipe__btn"
          href="${this.#data.sourceUrl}"
          target="_blank"
        >
          <span>Directions</span>
          <svg class="search__icon">
            <use href="${icons}#icon-arrow-right"></use>
          </svg>
        </a>
      </div>
  `;
  }
}
export default new RecipeView(); // ì´ë ‡ê²Œ í•˜ë©´ ì—¬ëŸ¬ viewë¥¼ ìƒì„±í•˜ê¸° ì‰½ë‹¤
```

### controller.js

```jsx
import * as model from "./model.js";

import "core-js/stable";
import "regenerator-runtime/runtime";
import recipeView from "./views/recipeView.js";
const recipeContainer = document.querySelector(".recipe");

const timeout = function (s) {
  return new Promise(function (_, reject) {
    setTimeout(function () {
      reject(new Error(`Request took too long! Timeout after ${s} second`));
    }, s * 1000);
  });
};

// https://forkify-api.herokuapp.com/v2

///////////////////////////////////////

const controlRecipe = async function () {
  try {
    // getHash
    const id = window.location.hash.slice(1);

    // guard clause
    if (!id) return;

    // loding svg
    recipeView.renderSpinner();

    // 1) Loding Recipe (from model.js)
    await model.loadRecipe(id);
    const { recipe } = model.state; // ìˆœìˆ˜í•¨ìˆ˜ë¥¼ ìœ„í•´ ì‚¬ë³¸ìœ¼ë¡œ ë°˜í™˜

    // 2) Rendering recipe
    recipeView.render(model.state.recipe); // 1. new ì—°ì‚°ìëŠ” viewì— ìˆê¸° ë•Œë¬¸ì—, RecipeViewì— ë°ì´í„°ë¥¼ ì „ë‹¬í• ìˆ˜ ì—†ë‹¤, ê·¸ë ‡ê¸° ë–„ë¬¸ì— renderë¼ëŠ” ë©”ì„œë“œë¡œ ê°ì²´ë¥¼ ë§Œë“¤ìˆ˜ ìˆë‹¤ (renderíŒ¨í„´ì„, ì‹¤ì œ ë©”ì„œë“œê°€ ì•„ë‹ˆë‹¤)
    // 1.1 renderê°€ ì—†ë‹¤ë©´ const recipeView = new RecipeView(model.state.recipe)ë¡œ ìƒì„±í•´ì•¼í•œë‹¤
    // 2. ì´ì œ model.state.recipe = ì¦‰ ë ˆì‹œí”¼ê°€, viewì˜ ë°ì´í„°ë¡œ ê°„ë‹¤, viewì—ì„œ markUpì„ ë Œë”ë§ í•˜ë©´ ëœë‹¤
    ì¶”ê°€í•˜ì;
  } catch (err) {
    console.error(new Error());
  }
};
// showRecipe();

["hashchange", "load"].forEach((ev) =>
  window.addEventListener(ev, controlRecipe)
);

// window.addEventListener('hashchange', showRecipe); // ì´ê±¸ ë™ì ìœ¼ë¡œ ì‚¬ìš©í•´ë³´ì
// window.addEventListener('load', showRecipe); // loadì´ë²¤íŠ¸ë¥¼ ì¶”ê°€
```

### model

```jsx
// model.js
import { async } from "regenerator-runtime";

export const state = {
  recipe: {},
};

export const loadRecipe = async function (id) {
  try {
    // loding recipe

    const res = await fetch(
      `https://forkify-api.herokuapp.com/api/v2/recipes/${id}`
    );
    const data = await res.json();

    // Gruad Cluase
    if (!res.ok) throw new Error(`${data.message} (${res.status})`);

    let { recipe } = data.data;
    state.recipe = {
      id: recipe.id,
      title: recipe.title,
      publisher: recipe.publisher,
      sourceUrl: recipe.source_url,
      image: recipe.image_url,
      servings: recipe.servings,
      cookingTime: recipe.cooking_time,
      ingredients: recipe.ingredients,
    };

    // console.log(recipe);
  } catch (err) {
    alert(err);
  }
};
```

![result](../../img/0316_02.gif)

# Publisher-Subscriber Design pattern

![result2](../../img/0316_03.png)

# í”„ë¡œê·¸ë˜ë¨¸ìŠ¤ ì •ë¦¬

### **1ë²ˆ ë¬¸ì œ**

![https://grepp-programmers.s3.amazonaws.com/production/lecture/learn/attachment/file/368/screen_shot_2019-06-04_at_8.14.40_pm.png](https://grepp-programmers.s3.amazonaws.com/production/lecture/learn/attachment/file/368/screen_shot_2019-06-04_at_8.14.40_pm.png)

- ì •ë‹µì€ 'ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤'
- `apply`,Â `call`,Â `bind`Â ë“±ìœ¼ë¡œÂ `this`ì— ëŒ€í•´ ì£¼ì…í•œ ìƒí™©ì´ ì•„ë‹ˆê³ Â `new`Â í‚¤ì›Œë“œì—†ì´ ì‹¤í–‰í•œ í•¨ìˆ˜ ë‚´ thisëŠ” ì „ì—­ ê°ì²´(window)ë¥¼ ë°”ë¼ë³¸ë‹¤.
- ì¦‰Â `this.name = name`ì˜ ê²°ê³¼ëŠ”Â `window.name = name`Â ì´ë¼ëŠ” ì´ì•¼ê¸°.

### **2ë²ˆ ë¬¸ì œ**

![https://grepp-programmers.s3.amazonaws.com/production/lecture/learn/attachment/file/369/screen_shot_2019-06-04_at_8.15.39_pm.png](https://grepp-programmers.s3.amazonaws.com/production/lecture/learn/attachment/file/369/screen_shot_2019-06-04_at_8.15.39_pm.png)

- `hello roto`ê°€ ì¶œë ¥ëœë‹¤.
- `ì™€ `ë¡œ ê°ì‹¼ ë¬¸ìì—´ì€ ES6ì— ìˆëŠ”Â `template strings`ë¼ëŠ” ë¬¸ë²•ìœ¼ë¡œ,
- ì¦‰ì‹œ ì‹¤í–‰ í•¨ìˆ˜ í‘œí˜„(IIFE, Immediately Invoked Function Expression)ì´ë¼ê³  í•˜ë©°, í•¨ìˆ˜ë¥¼ ì •ì˜í•¨ê³¼ ë™ì‹œì— ì‹¤í–‰í•œë‹¤.
- JavaScript íŠ¹ì„±ìƒ ë³€ìˆ˜ì˜ scopeëŠ” í•´ë‹¹ ë³€ìˆ˜ë¥¼ ê°ì‹¸ê³  ìˆëŠ” functionì— í•œì •ë˜ëŠ”ë°, ì´ê±¸ ì´ìš©í•´ ë³€ìˆ˜ë‚˜ í•¨ìˆ˜ì˜ ì „ì—­í™”ë¥¼ ìµœì†Œí™” ì‹œí‚¬ ìˆ˜ ìˆë‹¤.
- ë‹¤ìŒì€ ëŒ€í‘œì ì¸ IIFEì˜ ì‘ìš©ì´ë‹¤.

```
var logger = (function(){
// logCountëŠ” ë°–ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤. ì¼ì¢…ì˜ private íš¨ê³¼var logCount = 0;
functionlog(message) {
    console.log(message);
    logCount = logCount + 1;
  }
functiongetLogCount() {
return logCount;
  }
return {
    log: log,
    getLogCount: getLogCount
  }
})()

```

### **3ë²ˆ ë¬¸ì œ**

![https://grepp-programmers.s3.amazonaws.com/production/lecture/learn/attachment/file/370/screen_shot_2019-06-04_at_8.16.18_pm.png](https://grepp-programmers.s3.amazonaws.com/production/lecture/learn/attachment/file/370/screen_shot_2019-06-04_at_8.16.18_pm.png)

- function scope ê´€ë ¨ ë¬¸ì œ
- ì •ë‹µì€Â `band undefined roto play start.`Â ì¶œë ¥
- play í•¨ìˆ˜ì˜ this ë‚´ì—ëŠ” nameì´ ì—†ê¸° ë•Œë¬¸ì— undefinedê°€ ì¶œë ¥ ë˜ëŠ” ê²ƒ
- í•´ê²°ë²•

```
var idiots = {
  name: 'idiots',
  genre: 'punk rock',
  members: {
    roto: {
      memberName: 'roto',
      play:function() {
        console.log(`band ${idiots.name} ${this.memberName} play start.`
      }
    }
  }
}

```

### **4ë²ˆ ë¬¸ì œ**

![https://grepp-programmers.s3.amazonaws.com/production/lecture/learn/attachment/file/371/screen_shot_2019-06-04_at_8.16.56_pm.png](https://grepp-programmers.s3.amazonaws.com/production/lecture/learn/attachment/file/371/screen_shot_2019-06-04_at_8.16.56_pm.png)

- ë§¨ ì•„ë˜Â `theOralCigarettees.perform()`ì„ ì‹¤í–‰í•˜ëŠ” ê²Œ ë¹ ì¡Œë„¤ìš”..
- `perform`Â í•¨ìˆ˜ ì•„ë˜Â `setTimeout`ìœ¼ë¡œ ì¸í•´ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ì˜Â `this`ëŠ”Â `RockBand`ì˜Â `this`ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì—, ì°¸ì¡° ì˜¤ë¥˜ê°€ ë°œìƒ
- í´ë¡œì €ë¥¼ ì´ìš©í•œ í•´ê²°ë²•

```
functionRockBand(members) {
var that = this;
    this.members = members;
    this.perform =function() {
      setTimeout(function(){
        that.members.forEach(function(member){ member.perform() })
      }, 1000)
    }
  }

var theOralCigarettes =new RockBand([
    {
      name: 'takuya',
      perform:function() { console.log('a e u i a e u i')}
    }
  ])

  theOralCigarettes.perform()

```

- bindë¥¼ ì´ìš©í•œ í•´ê²°ë²•

```
functionRockBand(members) {
var that = this;
    this.members = members;
    this.perform =function() {
      setTimeout(function(){
        this.members.forEach(function(member){ member.perform() })
      }.bind(this), 1000)
    }
  }

var theOralCigarettes =new RockBand([
    {
      name: 'takuya',
      perform:function() { console.log('a e u i a e u i')}
    }
  ])

  theOralCigarettes.perform()

```

### **5ë²ˆ ë¬¸ì œ**

![https://grepp-programmers.s3.amazonaws.com/production/lecture/learn/attachment/file/372/screen_shot_2019-06-04_at_8.17.00_pm.png](https://grepp-programmers.s3.amazonaws.com/production/lecture/learn/attachment/file/372/screen_shot_2019-06-04_at_8.17.00_pm.png)

- ì „í˜•ì ì¸ í´ë¡œì ¸ ë¬¸ì œ
- setTimeoutì´ ì‹¤í–‰ë˜ëŠ” ì‹œì ì—ëŠ” ë£¨í”„ê°€ ì´ë¯¸ ëë‚˜ìˆì–´ì„œ iëŠ” 5ê°€ ë“¤ì–´ê°€ìˆì–´ì„œ ìƒê¸°ëŠ” ë¬¸ì œ
- ië¥¼ var ëŒ€ì‹ Â `let`ì„ ì“°ëŠ” ê±¸ë¡œ í•´ê²°í•  ìˆ˜ ìˆìŒ
- í˜¹ì€ setTimeoutì„ IIFEë¡œ ê°ì‹¸ê³ , íŒŒë¼ë©”í„°ë¡œ ië¥¼ ë„˜ê¸°ëŠ” ê²ƒìœ¼ë¡œ í•´ê²° ê°€ëŠ¥

```
const numbers = [1, 2, 3, 4, 5];
for(var i = 0; i < numbers.length; i++){
  (function(count){
    setTimeout(function(){
      console.log(`number index ${count}`);
    }, 1000);
  })(i)
}

```

### **6ë²ˆ ë¬¸ì œ**

forë¬¸ì„ ì´ìš©í•œ ë°©ë²•

```
function printCats() {
  const userNames = []
  for(let i = 0; i < users.length; i++) {
    if (users[i].type === 'cat') {
      userNames.push(users[i].name);
    }
  }
  console.log(userNames.join(''));
}

```

es5ë¥¼ ì´ìš©í•œ ë°©ë²•

```
function printCats() {
  console.log(users.filter(user => user.type === 'cat').map(user => user.name).join(''));
}

```

### **7ë²ˆ ë¬¸ì œ**

### **var, let, constì˜ ì°¨ì´**

- var: function level scopeë¥¼ ê°€ì§€ë©° ì´ë¡œ ì¸í•´ í˜¸ì´ìŠ¤íŒ… í˜„ìƒì´ ì¼ì–´ë‚œë‹¤. ì¬í• ë‹¹ ê°€ëŠ¥
- let: block level scopeë¥¼ ê°€ì§€ë©° ì¬í• ë‹¹ì´ ê°€ëŠ¥í•˜ë‹¤.
- const: block level scopeë¥¼ ê°€ì§€ë©° ì¬í• ë‹¹ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ê·¸ëŸ¬ë‚˜ í• ë‹¹ëœ ê°ì²´ì˜ í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ê°ì²´ë¥¼ ë³€ê²½í•˜ëŠ” ì¼ì€ ê°€ëŠ¥í•˜ë‹¤.

```
const arr1 = []

arr1 = [1,2]; // Error!

// ê°€ëŠ¥
arr1.push(1);
arr1.push(2);

```

### **8ë²ˆ ë¬¸ì œ**

### **í´ë¡œì €ë€?**

ì•„ë˜ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì.

- https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide/Closures
- https://hyunseob.github.io/2016/08/30/javascript-closure/

# ë§ˆì§€ë§‰ìœ¼ë¡œ

> ë‚´ì¼ì€ reactë¥¼ ì˜ ë‚˜ê°€ê³ , ë¦¬ë•ìŠ¤ ë³µìŠµì„ ì˜í•´ë³´ì
